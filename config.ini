# macwatcher configuration
# Copy to /etc/macwatcher/config.ini for system-wide deployment.

[scanner]
# Network interface to scan (use `ip link` to list available interfaces)
interface = wlan0

# ── Scan mode (mutually exclusive) ───────────────────────────────────────────
# arp-scan  — Active mode. Sends ARP requests to every host on the subnet.
#             Reliable detection of all devices, but generates network traffic.
# arpwatch  — Passive / promiscuous mode. Silently listens for ARP traffic.
#             Zero injected traffic, but can only see devices that talk.
scan_mode = arp-scan

# Seconds between polling cycles (applies to both modes)
scan_interval = 60

# ── arp-scan mode settings ───────────────────────────────────────────────────
# How many consecutive missed scans before a device is declared LEAVE.
# At the default interval of 60 s, threshold 3 means ~3 min of absence.
miss_threshold = 3

# Extra arguments passed directly to arp-scan.
# --localnet   : scan the entire local subnet automatically
# --retry=2    : send each probe twice to reduce false negatives
arp_scan_args = --localnet --retry=2

# Optional: path to a file mapping MAC addresses to friendly device names.
# Leave blank to disable.  See known-macs.conf.example for the format.
known_macs_file =

[arpwatch]
# Path to the arpwatch binary
arpwatch_bin = /usr/sbin/arpwatch

# Path to the arpwatch dat file (MAC/IP/timestamp table).
# Created automatically if it does not exist.
arpwatch_dat = /var/lib/macwatcher/arp.dat

# Extra flags for arpwatch (e.g. -n 192.168.1.0/24 to restrict subnet).
# Leave blank for defaults.
arpwatch_extra =

# Seconds of silence (no ARP traffic from a device) before declaring LEAVE.
# Passive mode only sees devices when they generate ARP traffic, so this
# should be longer than miss_threshold * scan_interval in active mode.
# Default 300 s = 5 minutes.
leave_timeout = 300

[database]
# Path to the TinyFlux CSV event log.
# The directory will be created automatically if it does not exist.
db_path = /var/lib/macwatcher/events.csv

[logging]
# Logging verbosity: DEBUG | INFO | WARNING | ERROR
log_level = INFO
